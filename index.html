<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>График температуры</title>
    <!-- Подключаем библиотеку mpld3 для отображения графика -->
    <script src="https://cdn.jsdelivr.net/npm/mpld3@0.5.5/dist/mpld3.min.js"></script>
</head>
<body>
    <h1>График температуры</h1>
    <!-- Вставляем сгенерированный HTML-код графика -->
    <div id="graph">
        <script>
            import requests
            import matplotlib.pyplot as plt
            import mpld3

            # Запрос данных с веб-сервера ThingSpeak
            url = 'https://api.thingspeak.com/channels/2447664/feeds.json?api_key=YGABPVZSCX5NJB3A'
            response = requests.get(url)
            data = response.json()

            # Извлечение данных о температуре
            temperatures = [float(entry['field1']) for entry in data['feeds']]

            # Создание списка временных меток для оси x
            timestamps = [entry['created_at'] for entry in data['feeds']]

            # Создание графика
            fig, ax = plt.subplots(figsize=(10, 6))
            ax.plot(timestamps, temperatures, marker='o', linestyle='-')
            ax.set_title('График температуры по данным с ThingSpeak')
            ax.set_xlabel('Время')
            ax.set_ylabel('Температура (градусы Цельсия)')
            ax.grid(True)
            fig.autofmt_xdate()  # Автоматически форматируем даты на оси x

            # Преобразуем график в HTML с помощью mpld3 и выводим его
            html_graph = mpld3.fig_to_html(fig)
            document.getElementById('graph').innerHTML = html_graph;
        </script>
    </div>
    <!-- Возможно, здесь будут другие элементы страницы -->
</body>
</html>
